data:
  rebuild_ds: false
  train:
    dataset: wikiann
    batch_size: 32
    num_workers: 4
    subset: 1.0
    shuffle: true
  eval:
    dataset: wikiann
    batch_size: 32
    num_workers: 1
    subset: 1.0
    shuffle: false
train:
  epochs: 20
  grad_clip: 1.0
eval:
  eval_only: false
  metrics_only: true
device: cuda
logging:
  metrics_only: false
array: 0
dora:
  exclude:
  - eval.*
  - data.rebuild_ds
  - logging.*
slurm:
  partition: boost_usr_prod
  gpus: 1
  mem_per_gpu: 32
  time: 240
  cpus_per_gpu: 8
  setup:
  - module load python/3.11.7
  - source /leonardo/home/userexternal/slusetti/MoE/.venv/bin/activate
  - export SLURM_CPU_BIND=none
  - export HF_HOME=/leonardo_work/IscrC_LUSE/slusetti/hf-cache
  - export HF_DATASETS_CACHE=$HF_HOME/datasets
  - export TRANSFORMERS_CACHE=$HF_HOME/transformers
  - export HF_MODULES_CACHE=$HF_HOME/modules
  - export HF_HUB_CACHE=$HF_HOME/hub
  - export HUGGINGFACE_HUB_CACHE=$HF_HOME/hub
  - export HF_HUB_OFFLINE=1
  - export TRANSFORMERS_OFFLINE=1
  - export HF_DATASETS_OFFLINE=1
product_model:
  input_dim: 384
  latent_dim: 256
  encoder_hidden: 512
  projector_hidden: 256
  num_subspaces: 4
  margin: 0.5
  temperature: 1.0
  betas:
    dis_spar: 0.1
    consistency: 0.1
    regularization: 0.1
  warmup_epochs:
    consistency: 5
    distance: 5
  losses:
    geom_sparsity: 0.05
    geom_orthogonality: 0.05
  optim:
    lr: 0.0005
    weight_decay: 1.0e-05
    betas:
    - 0.9
    - 0.999
